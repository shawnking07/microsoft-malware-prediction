# COMP9417 Project

Wei Wang, Mingqian Lin, Yishun Jin

## Topic

[Kaggle Microsoft Malware Prediction](https://www.kaggle.com/c/microsoft-malware-prediction)

## Introduction

This is a Kaggle competition, although the dataset is huge, we decided to use the original data without any scale. It may take a long time to run the training and prediction code.

You can run LightGBM in the **root directory**. Please make sure you had train.csv and test.csv downloaded and these two files can be found in the **root directory**. And also, you need to run python3 in **root directory** so that files can be found.

You can run baseline test in **./baseline/ directory**.  Make sure you've downloaded train.csv and test.csv from kaggle and these two files can be found in the **./baseline/ directory**. And please pay attention, you shall run baseline test in the **./baseline/ directory, not the root directory**.

You can run feature engineering code in the **root directory**. Please generate the **HDF5** files first, because our feature learning precessed in a long time, it will waste a lot of time if we use ``pandas.load_csv()`` to load these data sets each time. Command shows below:

```bash
vaex convert file train.csv train.csv.hd5
vaex convert file test.csv test.csv.hd5
```

## Workload

- Baseline and model selection (Wei Wang)
- Handle missing values (Wei Wang)
- Experiment with `KNNImputer` (Wei Wang)
- Feature engineering (Yishun Jin)
- Reduce memory (Yishun Jin)
- Using LightGBM (Yishun Jin)
- Dealing with specific features (Mingqian Lin)
- Result analysis (Mingqian Lin)

## Code structure

**train.csv**: training data (Not submitted, please download from kaggle)

**test.csv**: testing data (Not submitted, please download from kaggle)

**lightGBM.iypnb** / **lightGBM.py**: lightgbm training and parameter tuning

**train.model**: lightgbm model file

**environment.yml**: conda env file

**requirements.txt**: pip requirements

**baseline/common.py**: functions and definitions used in baseline

**baseline/baseline_test**: all kinds of baseline tests, experiments mentioned in report

**baseline/test.csv**: test file for baseline (Not submitted, please download from kaggle)

**baseline/train.csv**: train file for baseline (Not submitted, please download from kaggle)

**baseline/small_train.csv**: scaled train file generated by function `gen_small_train` from `common.py` (Not submitted, please generate if needed)

**baseline/submission.csv**: output of the prediction of test.csv (Not submitted, please generate if needed)

**baseline/out.txt**: output of baseline test

**baseline/out_knn.txt**: output of baseline test using KNNImputer

**right.py**: experiment about dealing with specific features

**report.md**: file for writing report, please ignore

**pics/**: file for writing report, please ignore
